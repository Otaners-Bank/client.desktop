import java.net.UnknownHostException;
import java.util.Scanner;
import org.bson.Document;
import com.mongodb.BasicDBObject;
import com.mongodb.Cursor;
import com.mongodb.DB;
import com.mongodb.DBCollection;
import com.mongodb.MongoClient;
import com.mongodb.MongoClientURI;
import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;

public class ConnectionTeste {

	private static MongoClientURI uri;
	private static MongoClient mongo;
	private static DB database;
	private static DBCollection collection;

	public static void main(String[] args) throws Exception {
		try {
		
			while(true == true) {
				
				connect();
				
				System.out.println("\n\n1-INSERIR \n2-ATUALIZAR \n3-DELETAR \n4-BUSCAR TODOS \n5-BUSCAR UM\n\n");

				Scanner sc = new Scanner(System.in);
				int opcao = sc.nextInt();

				
				
				switch (opcao) {
				
				case 0:
					
					disconnect();
					System.exit(0);
					
					break;
				
				case 1:

					System.out.println("Digite alguma coisa:");
					String strDocument_Insert = sc.next();
					
					Insert_Document(strDocument_Insert);

					break;

				case 2:

					System.out.println("Digite o antigo conteudo:");
					String strOldDocument_Update = sc.next();
					System.out.println("Digite o novo conteudo:");
					String strNewDocument_Update = sc.next();
					
					Update_Document(strNewDocument_Update,strOldDocument_Update);

					break;

				case 3:

					System.out.println("Digite o que quiser deletar:");
					String strDocument_Delete = sc.next();
					
					Delete_Document(strDocument_Delete);

					break;

				case 4:

					Read_Documents();

					break;

				case 5:
					
					System.out.println("Digite o que estiver procurando:");
					String strDocument_Read = sc.next();

					Read_Document(strDocument_Read);

					break;

				default:
					
					disconnect();
					
					break;
				}
				
				disconnect();
				
			}

			
		} catch (Exception e) {
			disconnect();
		}
	}

	private static void connect() {
		try {
			uri = new MongoClientURI(
					"mongodb+srv://thales:iambatman@teste-tngy3.mongodb.net/test?retryWrites=true&w=majority");
			
			mongo = new MongoClient(uri);
			database = mongo.getDB("DataBaseTeste");
			collection = database.getCollection("CollectionTeste");
		} catch (Exception e) {
			System.out.println(e);
		}
	}

	private static void disconnect() {
		try {
			mongo.close();
		} catch (Exception e) {
			System.out.println(e);
		}
	}

	public static void Insert_Document(String strDocument) {
		try {

			BasicDBObject document = new BasicDBObject("nome", strDocument);
			collection.insert(document);

		} catch (Exception e) {
			System.out.println(e);
		}
	}

	public static void Update_Document(String strNewDocument_Update, String strOldDocument_Update) {
		try {
			// new value
			BasicDBObject newDocument = new BasicDBObject("nome", strNewDocument_Update);
			
			// old value
			BasicDBObject oldDocument = new BasicDBObject("nome", strOldDocument_Update);
			
			collection.update(oldDocument, newDocument);
			
		} catch (Exception e) {
			System.out.println(e);
		}
	}

	public static void Delete_Document(String strDocument) {
		try {

			//BasicDBObject document = new BasicDBObject("nome", strDocument);
			
			//collection.remove(document);
			
			//collection.drop();
			
			
		} catch (Exception e) {
			System.out.println(e);
		}
	}
	
	public static void Read_Documents() {
		try {

			Cursor cursor = collection.find();
			while (cursor.hasNext()) {
				System.out.println(cursor.next());

			}

		} catch (Exception e) {
			System.out.println(e);
		}
	}
	
	public static void Read_Document(String strDocument) {
		try {

			BasicDBObject document = new BasicDBObject("nome",strDocument);
			
			Cursor cursor = collection.find(document);
			while (cursor.hasNext()) {
				System.out.println(cursor.next());

			}

		} catch (Exception e) {
			System.out.println(e);
		}
	}

}
